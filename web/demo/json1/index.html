<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>json获取select、li数据列表</title>
</head>
<body>
<div class="main">
	<!--三级联动-->
    <!--选择城市-->
	<select id="cityall">
    	<option value="0">请选择</option>
    </select>
    <!--选择品牌店-->
	<select id="cityshop">
    	<option value="0">请选择</option>
    </select>    
    <!--选择销售员-->
	<select id="seller">
    	<option value="0">请选择</option>
    </select>    
</div>
<script type="text/javascript" src="../jquery-1.8.3.min.js"></script>
<script type="text/javascript">
    /*判断下拉框是否选择第一项*/
function isFirstOptSelected(domID) {
	return (document.getElementById(domID).selectedIndex == 0);
};
	var cityItems="";
	var htmlcityitems="";
	var citynum="";
	var shopnum="";
/*json数据格式，注意层级，{},[] , :的使用*/	
	var Jsoncity=[
		{'city':'北京','shop':[{'shopname':'商城1','seller':[{'sellname':'sell1'},{'sellname':'sell2'},]},{'shopname':'商城2','seller':[{'sellname':'sell21'},{'sellname':'sell22'},]},{'shopname':'商城3','seller':[{'sellname':'sell31'},{'sellname':'sell32'}]}]},
		{'city':'上海','shop':[{'shopname':'商城1'},{'shopname':'商城2'},{'shopname':'商城3'},{'shopname':'商城4'}]},
		{'city':'广州','shop':[{'shopname':'商城1'},{'shopname':'商城2'},{'shopname':'商城3'},{'shopname':'商城4'},{'shopname':'商城5'}]},
		{'city':'珠海','shop':[{'shopname':'商城1'},{'shopname':'商城2'},{'shopname':'商城3'},{'shopname':'商城4'},{'shopname':'商城5'},{'shopname':'商城6'}]}];

/*判断第一级的长度，并生成select的html，插入*/	
	for(var i=0; i<Jsoncity.length; i++){
			var j=i+1;
			cityItems+='<option class="'+j+'" value="'+Jsoncity[i].city+'">'+Jsoncity[i].city+'</option>';
		}
	var htmlcityitems='<option value="0">请选择</option>'+cityItems+'';
	$('#cityall').html(htmlcityitems);

/*判断第一集的change事件，然后为第二集赋值*/	
	$('#cityall').on("change",function(){
		if(isFirstOptSelected("cityall")){//判断第一级是否选择第一项
			$('#cityshop').html('<option value="0">请选择</option>')//上一级选择选择第一项，则第二级生成默认内容
			}else{//否则生成第二级html
				var thisval=$(this).val();//判断第一级选择想val
				for(var i=0; i<Jsoncity.length;i++){
					if(Jsoncity[i].city==thisval){
						citynum=i;//获取第一级选择项的数值顺序
						break;
						};
					};
					if(citynum!="undefined"){//第一项选择内容不为空
						var shopitems="";
						var htmlshopitems="";
						for(var i=0; i<Jsoncity[citynum].shop.length;i++){//根据第一级选择项的顺序，匹配其其二级长度
							shopitems+='<option value="'+Jsoncity[citynum].shop[i].shopname+'">'+Jsoncity[citynum].shop[i].shopname+'</option>';//生成第二级select的html
							}}
						var htmlshopitems='<option value="0">请选择</option>'+shopitems+'';
						$('#cityshop').html(htmlshopitems);//将二级select内容插入select
						//第二级change，则生成第三级html
						$('#cityshop').on("change",function(){
							if(isFirstOptSelected("cityshop")){
								$('#seller').html('<option value="0">请选择</option>')
								}else{
									//判断二级选择项的值，获取其位置
									var thisval=$(this).val();
									for(var i=0; i<Jsoncity[citynum]["shop"].length;i++){
										if(Jsoncity[citynum]["shop"][i].shopname==thisval){
											shopnum=i;
											break;
											};
										};
										if(shopnum!="undefined"){
											var selleritems="";
											var htmlselleritems="";
											//根据第一级、第二级的选择项顺序，获取第三级内容长度，并生成html，插入
											for(var i=0; i<Jsoncity[citynum].shop[shopnum].seller.length;i++){
												selleritems+='<option value="'+Jsoncity[citynum].shop[shopnum].seller[i].sellname+'">'+Jsoncity[citynum].shop[shopnum].seller[i].sellname+'</option>';
												}}
											var htmlselleritems='<option value="0">请选择</option>'+selleritems+'';
											$('#seller').html(htmlselleritems);

											}
									}
							)
						}
		})
	
</script>
</body>
</html>
